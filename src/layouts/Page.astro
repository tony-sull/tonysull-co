---
import Layout from './Base.astro'
import ArticlesBlock from '../components/ArticlesBlock.astro'
import Hero from '../components/Hero.astro'

interface Content {
  title: string
  description: string
  blocks: CMS.UI.Block[]
}

interface Props {
  content: Content
}

const { content } = Astro.props as Props
const { title, description, blocks } = content

const hasHero = blocks.some(({ type }) => type === 'hero')
---

<Layout title={title} description={description} canonicalURL={Astro.request.canonicalURL}>
  {!hasHero && (<h1>{title}</h1>)}

  {blocks.map(({ type, ...data }) => {
    switch (type) {
      case 'hero':
        return (
          <Hero {...data} />
        )
      case 'articles':
        return (
          <ArticlesBlock {...data} />
        )
    }
  })}
</Layout>

<style lang="scss">
  h1 {
    margin: var(--spacer-md) 0;
  }
</style>